<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>PDF to Word Converter</title>
  <style>
    body { font-family: Arial; padding: 30px; }
    #status { margin-top: 10px; color: green; }
  </style>
</head>
<body>
  <h2>Upload PDF to Convert to Word</h2>
  <form id="uploadForm">
    <input type="file" id="pdf" name="pdf" accept=".pdf" required />
    <button type="submit">Convert</button>
  </form>

  <div id="status"></div>
  <a id="downloadLink" style="display: none;" download>⬇️ Download Converted Word</a>

  <script>
    const form = document.getElementById('uploadForm');
    const statusBox = document.getElementById('status');
    const downloadLink = document.getElementById('downloadLink');

    form.addEventListener('submit', async function (e) {
      e.preventDefault();

      const fileInput = document.getElementById('pdf');
      const formData = new FormData();
      formData.append('pdf', fileInput.files[0]);

      statusBox.textContent = '⏳ Uploading and converting...';
      downloadLink.style.display = 'none';

      try {
        const response = await fetch('http://localhost:5000/convert', {
          method: 'POST',
          body: formData
        });

        const result = await response.json();

        if (result.success) {
          const fileId = result.file_id;
          downloadLink.href = `http://localhost:5000/converted/${fileId}.docx`;
          downloadLink.style.display = 'inline';
          statusBox.textContent = '✅ Conversion complete. Click below to download:';
        } else {
          statusBox.textContent = `❌ Error: ${result.error}`;
        }
      } catch (err) {
        statusBox.textContent = '❌ Conversion failed or server not running.';
      }
    });
  </script>
</body>
</html>
